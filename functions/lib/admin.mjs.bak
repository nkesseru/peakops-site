import admin from 'firebase-admin';
let app;
export function getDb() {
  if (!app) {
    app = admin.apps.length ? admin.app() : admin.initializeApp();
    const pid = process.env.GCLOUD_PROJECT || process.env.GOOGLE_CLOUD_PROJECT || (admin.app().options?.projectId) || 'unknown';
    console.log('[admin] initialized (ADC). project:', pid);
  }
  return admin.firestore();
}
